import hljs from 'highlight.js';
import ignoreFm from './jade-filter-ignorefrontmatter';

export default (jadeLang, jadeRuntime, jadeFilters) =>
  function(text, options) {
    // Remove front matter and render
    let html = ignoreFm(jadeLang, jadeRuntime, jadeFilters)(text);

    // Remove first empty line generated by Jade
    html = html.replace(/^\n/g, '');

    // Enforce HTML syntax
    hljs.configure({languages: [ 'html' ]});

    let code = jadeFilters('highlight', html);

    // Undo global hljs configs
    hljs.configure({languages: null});

    return code;
  }
;

//! Copyright AXA Versicherungen AG 2015
